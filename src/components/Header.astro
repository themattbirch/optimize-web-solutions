---
// src/components/Header.astro
import { Image } from "astro:assets";
import darkLogo from "../assets/images/optimize-web-solutions-logo.png";
import lightLogo from "../assets/images/optimize-web-solutions-logo-light.webp";
import OpenIcon from "./OpenIcon.astro";
import CloseIcon from "./CloseIcon.astro";
import ThemeToggle from "./ThemeToggle.jsx";

const links = [
  { title: "Home", path: "/" },
  { title: "About", path: "/about" },
  { title: "Services", path: "/services" },
  { title: "Contact", path: "/contact" },
];
---

<header
  id="site-header"
  class="sticky top-0 z-50 w-full bg-transparent transition-all duration-300
         scrolled-self:bg-white/90 scrolled-self:dark:bg-slate-900/90
         scrolled-self:backdrop-blur-sm scrolled-self:shadow-lg"
>
  <div
    class="mx-auto flex max-w-screen-xl items-center justify-between px-4 py-4 md:py-5"
  >
    <a href="/" aria-label="Optimize Web Solutions" class="shrink-0">
      <Image
        src={lightLogo}
        alt=""
        loading="eager"
        width="160"
        class="block dark:hidden"
      />
      <Image src={darkLogo} alt="" width="160" class="hidden dark:block" />
    </a>

    <div class="hidden lg:flex items-center gap-8 font-heading">
      <ThemeToggle client:load className="text-gray-900 dark:text-white" />
      {
        links.map((l) => (
          <a
            href={l.path}
            class="px-4 py-2 text-gray-900 dark:text-white hover:text-accent-primary transition-colors"
          >
            {l.title}
          </a>
        ))
      }
      {/* "Book Us" button has been removed from here. */}
    </div>

    <div class="flex lg:hidden items-center gap-2">
      <ThemeToggle client:load className="text-gray-900 dark:text-white" />
      <button
        id="mobile-menu-button"
        class="p-2 rounded-md focus:outline-none text-gray-900 dark:text-white"
        aria-expanded="false"
        aria-label="Open menu"
      >
        <OpenIcon class="block h-6 w-6" />
        <CloseIcon class="hidden h-6 w-6" />
      </button>
    </div>
  </div>

  <nav
    id="mobile-menu"
    class="lg:hidden absolute top-full inset-x-0 bg-[rgba(255,255,255,0.9)] dark:bg-[rgba(15,23,42,0.92)] backdrop-blur p-4 rounded-b-md opacity-0 pointer-events-none transform -translate-y-2 transition-all"
  >
    <ul class="space-y-2">
      {
        links.map((l) => (
          <li>
            <a
              href={l.path}
              class="mobile-link block text-gray-900 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 px-3 py-2 rounded-md"
            >
              {l.title}
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
</header>

<script is:inline>
  const header = document.getElementById("site-header");
  const scrollThreshold = 10; // Pixels to scroll before the background appears

  const handleScroll = () => {
    if (window.scrollY > scrollThreshold) {
      header.classList.add("scrolled");
    } else {
      header.classList.remove("scrolled");
    }
  };

  window.addEventListener("scroll", handleScroll, { passive: true });
  document.addEventListener("DOMContentLoaded", handleScroll); // Check on initial load
</script>
